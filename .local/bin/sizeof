#!/bin/bash

# prints help documenation
function usage() {
    cat <<EOF
    Usage:
    $0 [-bmkg]  [ file ]
    -b    Bytes
    -m    MegaBytes
    -k    KiloBytes
    -g    GigaBytes
EOF
    exit 1
}


# prints size converted into given unit
function printSize () {
    filesize="$(wc --bytes $3 | awk '{print $1}')"
    echo -e "$( bc <<<"scale=3; $filesize / $2" ) $1"
}


# print usage in various cases
if [[ $# -eq 0 || $1 == "-h" || $1 == "--help" ]]; then
    usage
fi

# get the last argument and check if it is a valid file
filename="${@: -1}"
if ! [ -f $filename ]; then
    echo "Enter a valid file path"
    exit 1
fi

# cycle through arguments
while getopts "bmkg" opt; do
    case "${opt}" in 
        b)
            printSize "Bytes" 1 $filename
            ;;
        k)
            printSize "KiloBytes" 1024 $filename
            ;;
        m)
            printSize "MegaBytes" 1048576 $filename
            ;;
        g)
            printSize "GigaBytes" 1073741824 $filename
            ;;
        h)
            usage
            ;;
        *)
            echo "Invalid option"
            ;;
    esac
done
